<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>GENIVI SOTA Project : Client commands and events API reference</title>
        <meta name="description" content="Software Updates Over the Air">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/rvi_sota_server/css/main.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    </head>
    <body>

        <div class="container-fluid">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <h4><img src="/rvi_sota_server/images/icon-logo.png"> <a class="brand" href="/rvi_sota_server/">GENIVI SOTA Project</a> / 
    Software Updates Over the Air
</h4>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-3">
                        <ul class="nav nav-list">
    <li><a href="/rvi_sota_server/">Home</a></li>
    
        
        

        
            
                <li class="nav-header">Getting Started</li>
            
            <li data-order="2"><a href="/rvi_sota_server/doc/deployment-with-dockercompose.html">Deployment with docker-compose</a></li>
        
            
            <li data-order="3"><a href="/rvi_sota_server/doc/admin-gui-user-guide.html">Admin GUI Guide</a></li>
        
            
            <li data-order="1"><a href="/rvi_sota_server/doc/building-installing.html">Building & Deploying</a></li>
        
    
        
        

        
            
                <li class="nav-header">Developers</li>
            
            <li data-order="10"><a href="/rvi_sota_server/dev/generated-documentation.html">Auto-generated Documentation</a></li>
        
            
            <li data-order="4"><a href="/rvi_sota_server/dev/architecture.html">SOTA Architecture</a></li>
        
            
            <li data-order="1"><a href="/rvi_sota_server/dev/contributing.html">Contributing</a></li>
        
            
            <li data-order="6"><a href="/rvi_sota_server/dev/database-style-guide.html">Database Style Guide</a></li>
        
            
            <li data-order="5"><a href="/rvi_sota_server/dev/scala-style-guide.html">Scala Style Guide</a></li>
        
            
            <li data-order="1"><a href="/rvi_sota_server/dev/api.html">API</a></li>
        
    
        
        

        
            
                <li class="nav-header">Client Documentation</li>
            
            <li data-order="3"><a href="/rvi_sota_server/cli/client-commands-and-events-reference.html">Client commands and events API reference</a></li>
        
            
            <li data-order="1"><a href="/rvi_sota_server/cli/introduction.html">Introduction</a></li>
        
            
            <li data-order="2"><a href="/rvi_sota_server/cli/client-startup-and-configuration.html">Client Startup and Configuration</a></li>
        
            
            <li data-order="8"><a href="/rvi_sota_server/cli/client-implementation-example-session.html">RVI Client Implementation Example Session</a></li>
        
            
            <li data-order="7"><a href="/rvi_sota_server/cli/client-implementation.html">RVI Client Implementation Reference</a></li>
        
    
        
        

        
            
                <li class="nav-header">Security Approach</li>
            
            <li data-order=""><a href="/rvi_sota_server/sec/security-threats-mitigations.html">Security Threats & Mitigations</a></li>
        
            
            <li data-order=""><a href="/rvi_sota_server/sec/whitelisted-interactions.html">Whitelisted Interactions</a></li>
        
    
        
        

        
            
                <li class="nav-header">Reference</li>
            
            <li data-order=""><a href="/rvi_sota_server/ref/dependencies.html">Dependencies</a></li>
        
            
            <li data-order="5"><a href="/rvi_sota_server/ref/use-cases.html">Use Cases</a></li>
        
            
            <li data-order="4"><a href="/rvi_sota_server/ref/requirements.html">Requirements</a></li>
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>

                    <div id="content" class="col-sm-9">
                        <div id="content" class="col-sm-10">
                            <div class="page-header">
    <h2>Client commands and events API reference
        
    </h2>
</div>

<div class="paragraph">
<p>The SOTA Client communicates with the host system over a command and event API. This API can function over a number of different gateways; see <a href="../cli/client-startup-and-configuration.html">Client Startup and Configuration</a> for details on gateway configuration.</p>
</div>
<div class="paragraph">
<p>The client receives <strong>commands</strong>, and broadcasts <strong>events</strong>. Any interested parties on the system can subscribe to events, and send commands to the client. A quick overview of the commands and events is given here; if you want more detailed information on the exact structure of the command and event bodies, check out the RustDocs for <a href="../gen_docs/client/sota/datatype/command/enum.Command.html">commands</a> and <a href="../gen_docs/client/sota/datatype/event/enum.Event.html">events</a>, respectively.</p>
</div>
<div class="sect1">
<h2 id="events">Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Error(String)</code> — General error event with a printable representation for debugging.</p>
</div>
<div class="paragraph">
<p><code>Authenticated</code> — Authentication with SOTA Core was successful.</p>
</div>
<div class="paragraph">
<p><code>NotAuthenticated</code> — An operation failed because we are not currently authenticated.</p>
</div>
<div class="paragraph">
<p><code>UpdatesReceived(Vec&lt;UpdateRequest&gt;)</code> — Client has received a notification from Core of pending or in-flight updates. It includes a vector of one or more update UUIDs received from Core.</p>
</div>
<div class="paragraph">
<p><code>UpdateAvailable(UpdateAvailable)</code> — Used only when using RVI: a notification from RVI of a pending update.</p>
</div>
<div class="paragraph">
<p><code>NoUpdateRequests</code> — The client has no more outstanding update requests.</p>
</div>
<div class="paragraph">
<p><code>FoundInstalledPackages(Vec&lt;Package&gt;)</code> — The following packages are installed on the device.</p>
</div>
<div class="paragraph">
<p><code>FoundSystemInfo(String)</code> — An update on the system information was received.</p>
</div>
<div class="paragraph">
<p><code>DownloadingUpdate(UpdateRequestId)</code> — Downloading an update.</p>
</div>
<div class="paragraph">
<p><code>DownloadComplete(DownloadComplete)</code> — An update was downloaded.</p>
</div>
<div class="paragraph">
<p><code>DownloadFailed(UpdateRequestId, String)</code> — Downloading an update failed.</p>
</div>
<div class="paragraph">
<p><code>InstallingUpdate(UpdateRequestId)</code> — Installing an update.</p>
</div>
<div class="paragraph">
<p><code>InstallComplete(UpdateReport)</code> — An update was installed.</p>
</div>
<div class="paragraph">
<p><code>InstallFailed(UpdateReport)</code> — The installation of an update failed.</p>
</div>
<div class="paragraph">
<p><code>UpdateReportSent</code> — An update report was sent to the Core server.</p>
</div>
<div class="paragraph">
<p><code>InstalledPackagesSent</code> — A list of installed packages was sent to the Core server.</p>
</div>
<div class="paragraph">
<p><code>InstalledSoftwareSent</code> — A list of installed software was sent to the Core server.</p>
</div>
<div class="paragraph">
<p><code>SystemInfoSent</code> — The system information was sent to the Core server.</p>
</div>
<div class="paragraph">
<p><code>InstalledSoftwareNeeded</code> — A broadcast event requesting an update on externally installed software.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commands">Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Authenticate(Option&lt;ClientCredentials&gt;)</code> — Authenticate with the auth server.</p>
</div>
<div class="paragraph">
<p><code>Shutdown</code> — Shutdown the client immediately.</p>
</div>
<div class="paragraph">
<p><code>GetUpdateRequests</code> — Check for any pending or in-flight updates.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Assuming a polling interval is set, the client will periodically check for updates. If the polling interval is set to 0, this command can be sent to force the client to check for updates. This would be useful, for example, in a system with SMS shoulder-tap notifications.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>ListInstalledPackages</code> — List the installed packages on the system.</p>
</div>
<div class="paragraph">
<p><code>ListSystemInfo</code> — List the system information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This tells the client to invoke the command set for <code>system_info</code> in the client configuration file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>StartDownload(UpdateRequestId)</code> — Start downloading an update.</p>
</div>
<div class="paragraph">
<p><code>StartInstall(UpdateRequestId)</code> — Start installing an update.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This only applies if the package_manager is set to <code>deb</code> or <code>rpm</code> in the config file. If it&#8217;s set to <code>off</code>, the software loading manager would start the install after it sees a DownloadComplete event.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>SendInstalledPackages(Vec&lt;Package&gt;)</code> — Send a list of packages to the Core server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
SendInstalledPackages is intended to send a complete list of all packages on the device. Each time you send the command, the complete list of packages on Core will be <strong>overwritten</strong> with the info you send—not updated or appended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>SendInstalledSoftware(InstalledSoftware)</code> — Send a list of all packages and firmware to the Core server.</p>
</div>
<div class="paragraph">
<p><code>SendSystemInfo</code> — Send the system information to the Core server.</p>
</div>
<div class="paragraph">
<p><code>SendUpdateReport(UpdateReport)</code> — Send a package update report to the Core server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gateways">Gateways</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The commands and events, in general, are the same regardless of the gateway used. The exact invocation method may differ, however, and certain gateways may not support all commands/events.</p>
</div>
<div class="sect2">
<h3 id="d-bus">D-Bus</h3>

</div>
<div class="sect2">
<h3 id="unix-domain-socket">Unix domain socket</h3>
<div class="sect3">
<h4 id="sendupdatereport">SendUpdateReport</h4>
<div class="paragraph">
<p>The Unix domain socket gateway supports a limited version of the SendUpdateReport command. The form of the command over unix domain sockets is <code>SendUpdateReport update_id result_code</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The update ID is the one received from the <code>DownloadComplete</code> message.</p>
</li>
<li>
<p>The result of the update attempt, either in numberical or verbal form. The possible update codes are enumerated here:</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 25%;">
<col style="width: 62.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Numerical</th>
<th class="tableblock halign-left valign-top">Verbal</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operation executed successfully</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALREADY_PROCESSED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operation has already been processed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEPENDENCY_FAILURE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency failure during package install, upgrade, or removal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VALIDATION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update image integrity has been compromised</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Package installation failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPGRADE_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Package upgrade failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REMOVAL_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Package removal failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLASH_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The module loader could not flash its managed module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATE_PARTITION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partition creation failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE_PARTITION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partition deletion failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESIZE_PARTITION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partition resize failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRITE_PARTITION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partition write failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_PARTITION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partition patching failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER_DECLINED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User declined the update</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOFTWARE_BLACKLISTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Software was blacklisted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISK_FULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ran out of disk space</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT_FOUND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Software package not found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OLD_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tried to downgrade to older version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTERNAL_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SWM Internal integrity error</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GENERAL_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other error</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sendinstalledpackages">SendInstalledPackages</h4>
<div class="paragraph">
<p>The syntax for SendInstalledPackages is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SendInstalledPackages package1_name package1_version package2_name package2_version [...] packageN_name packageN_version</pre>
</div>
</div>
<div class="paragraph">
<p>Package names and versions can&#8217;t contain spaces, but there are no other character restrictions. For example, all of the package/versions listed here are valid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SendInstalledPackages gcc 7.63 Movie&amp;MusicPlayer rc2-beta3 ECU9274927BF82-firmware gitID-2fab572</pre>
</div>
</div>
<div class="paragraph">
<p>Note, however, that all packages must have a version.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="websocket">Websocket</h3>

</div>
<div class="sect2">
<h3 id="console">Console</h3>

</div>
<div class="sect2">
<h3 id="http">HTTP</h3>

</div>
</div>
</div>

                        </div>
                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="https://github.com/advancedtelematic/rvi_sota_server">GENIVI SOTA Project</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69301419-1', 'auto');
  ga('send', 'pageview');
</script>

        
    </body>
</html>
