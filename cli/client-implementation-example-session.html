<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>GENIVI SOTA Project : RVI Client Implementation Example Session</title>
        <meta name="description" content="Software Updates Over the Air">

        <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/favicon/manifest.json">
        <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg">
        <link rel="shortcut icon" href="/favicon/favicon.ico">
        <meta name="msapplication-config" content="/favicon/browserconfig.xml">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css"> 
        <link rel="stylesheet" href="/rvi_sota_server/css/main.css">
        <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>
    </head>
    <body>
        
      <nav class="top-bar navbar navbar-default navbar-fixed-top text-spacing-md" id="header-navbar">
        <div class="top-bar container-fluid header-wrapper">
          <div class="top-bar navbar-header">
            <button class="navbar-toggle collapsed menu-selector-btn header-collapse-trigger" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-expanded="false" aria-controls="navbar-menu">
              <span class="sr-only">toggle</span>
              <span class="icon-bar top-bar"></span>
              <span class="icon-bar middle-bar"></span>
              <span class="icon-bar bottom-bar"></span>
            </button>
            <a class="top-bar navbar-brand" href="/rvi_sota_server/index.html"><img class="top-bar unfolded-header" src="/rvi_sota_server/images/icon-logo.png" alt="rvi_sota_server"></a>

          </div>
          <ul class="top-bar nav navbar-nav navbar-right visible-md visible-lg visible-sm">
            <li class="top-bar visible-sm visible-md visible-lg">
              <a class="top-bar ats-garage-btn" href="https://advancedtelematic.com/" target="_blank">Developed by ATS
              </a>
            </li>
          </ul>
          <div class="top-bar navbar-collapse collapse header-collapse-nav" id="navbar-menu">
            <div class="top-bar container center-nav-container">
              <div class="btn-container visible-xs">
                <a class="ico-arrow-top-right btn-small text-center uppercase" href="https://app.atsgarage.com/login" target="_blank">Start Now</a>
              </div>
              <div class="btn-container visible-xs">
                <a class="inverted btn-small text-center uppercase" href="https://app.atsgarage.com/login" target="_blank">Login</a>
              </div>
              <ul class="top-bar nav nav-list navbar-nav">
	            
	                <li class="top-bar "><a href="https://github.com/genivi/rvi_sota_server">Server src (stable)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/advancedtelematic/rvi_sota_server">Server src (dev)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/genivi/rvi_sota_client">Client src (stable)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/advancedtelematic/rvi_sota_client">Client src (dev)</a></li>
	            
	                <li class="top-bar docs"><a href="http://advancedtelematic.github.io/rvi_sota_server/">Docs</a></li>
	            

                <li class="visible-xs second-menu separator"></li>
                <li class="second-menu visible-xs clearfix">
                  <ul class="column">
                    <li><a href="http://atsgarage.com/en/privacy-policy.html" target="_blank">Privacy Policy</a></li>
                    <li><a href="http://atsgarage.com/en/terms-conditions.html" target="_blank">Terms of Use</a></li>
                    <li><a href="http://atsgarage.com/en/imprint.html" target="_blank">Imprint</a></li>
                  </ul>
                  <ul class="column">
                    <li><a href="https://github.com/advancedtelematic" target="_blank">Github</a></li>
                    <li><a href="https://twitter.com/ats_news" target="_blank">Twitter</a></li>
                  </ul>
                </li>
                <li class="second-menu small-logo visible-xs">
                  <img src="http://advancedtelematic.com/images/ats_small_logo_white.svg" alt="ATS Advanced Telematic Systems">
                </li>
              </ul>
            </div>
          </div>
        </div>
      </nav>
    

        <div id="main-body">
            <button id="toggle-navigation" class="collapsed">Categories</button>
            <div id="navigation" class="collapsed">
                <ul class="nav nav-tabs nav-justified" data-tabs="tabs">
    
    
    
    
    <li  class="active" ><a data-toggle="tab" href="#genivi">GENIVI SOTA</a></li>
    
</ul>

<div class="tab-content">

    
    
    
    

    <div id="genivi" class="tab-pane fade in  active ">

        <ul class="nav nav-list">
        
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Getting Started</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/deployment-with-dockercompose.html">Deploying with docker-compose</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/building-installing.html">Building & Deploying from Source</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/admin-gui-user-guide.html">Admin GUI Guide</a></li>
                    
                
            
                
            
                
            
                
            
        
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Developers</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/api.html">API</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/contributing.html">Contributing</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/architecture.html">SOTA Architecture</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/application-configuration-options.html">Application configuration options</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/scala-style-guide.html">Scala Style Guide</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/messaging-in-rvisotaserver.html">Messaging in rvi_sota_server</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/database-style-guide.html">Database Style Guide</a></li>
                    
                
            
                
            
                
            
        
            
                
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Client Documentation</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/introduction.html">Introduction</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/building-the-sota-client.html">Building the SOTA Client</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-startup-and-configuration.html">Client Startup and Configuration</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-commands-and-events-reference.html">Client commands and events API reference</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-implementation.html">RVI Client Implementation Reference</a></li>
                    
                            
                        <li><a class="nav-link  active " href="/rvi_sota_server/cli/client-implementation-example-session.html">RVI Client Implementation Example Session</a></li>
                    
                
            
                
            
        
            
                
            
                
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Reference</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/dependencies.html">Dependencies</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/requirements.html">Requirements</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/use-cases.html">Use Cases</a></li>
                    
                
            
        
        </ul>

    </div>
    
</div>


            </div>

            <div id="content">
                <div class="page-header">
    <h2>RVI Client Implementation Example Session
        
    </h2>
</div>

<div class="paragraph">
<p>This page takes a look at a typical RVI client session, where the client connects to the RVI node, gets notified of an available update, downloads and installs the update, and reports the success back to the server. We&#8217;ll break this down in detail, and look at each of the steps of the process. You can also download <a href="/rvi_sota_server/example-client-session.log">the debug log file from this session</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Registering services</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Client connects to RVI node.</p>
</li>
<li>
<p>RVI node lists the services it has available.</p>
</li>
<li>
<p>Client registers its available services with the RVI node.</p>
</li>
<li>
<p>Client gets the fully qualified names of its services from the node in return.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Package notification and download</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Client receives a notification from the server that a package update is available.</p>
</li>
<li>
<p>Client tells the server it can start sending the package.</p>
</li>
<li>
<p>Server tells the client the package&#8217;s SHA1 checksum, and the total number of 64kb chunks in the package, and the client acknowledges.</p>
</li>
<li>
<p>Server starts sending chunks, and the client acknowledges each one.</p>
</li>
<li>
<p>Once the client has acknowledged all the chunks, the server tells the client the transfer is finished.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Package installation and report</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The client assembles the chunks, and calls the local software loading manager to install the package.</p>
</li>
<li>
<p>Once the SLM terminates, the client sends a report back to the server with the success or failure of the package install.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect1">
<h2 id="1-registering-services">1. Registering Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the client connects to the RVI node, the first thing that needs to happen is an exchange of information about services: the client registers with the RVI node all of the services it implements, and the RVI node tells the client which services it has available. The RVI node also gives the client a unique name for each service it registers.</p>
</div>
<div class="paragraph">
<p>Here is how the RVI node notifies the client about an available service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">1</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;services_available&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;services&quot;</span>: [
      <span style="color: #BA2121">&quot;genivi.org/backend/sota/start&quot;</span>
    ]
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Currently, the services the RVI node will make available are <code>genivi.org/backend/sota/start</code>, <code>genivi.org/backend/sota/ack</code>, <code>genivi.org/backend/sota/report</code>, and <code>genivi.org/backend/sota/packages</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is how the client registers a service with the RVI node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">2649007917144</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;register_service&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;network_address&quot;</span>: <span style="color: #BA2121">&quot;sota_client_1:8090&quot;</span>, <i class="conum" data-value="1"></i><b>(1)</b>
    <span style="color: #008000; font-weight: bold">&quot;service&quot;</span>: <span style="color: #BA2121">&quot;/sota/notify&quot;</span>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This session was running in docker containers, with <code>sota_client_1</code> as the hostname of the client container. It would be more common to supply an ip address.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The client registers 5 services with RVI: <code>/sota/start</code>, <code>/sota/chunk</code>, <code>/sota/finish</code>, <code>/sota/getpackages</code>, and <code>/sota/abort</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The RVI node responds with a status code and the <em>fully qualified</em> name of the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">2649007917144</span>,
  <span style="color: #008000; font-weight: bold">&quot;result&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;status&quot;</span>: <span style="color: #666666">0</span>,
    <span style="color: #008000; font-weight: bold">&quot;service&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/notify&quot;</span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s important for the client to save each service name&#8212;&#8203;it will be sent with future requests.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="2-package-notification-and-download">2. Package notification and download</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When an update is ready to install, the server will send a message to the client&#8217;s <code>/sota/notify</code> service. Let&#8217;s take a look at the message, and explain the elements of it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">1</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;/sota/notify&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [ <i class="conum" data-value="1"></i><b>(1)</b>
      {
        <span style="color: #008000; font-weight: bold">&quot;services&quot;</span>: { <i class="conum" data-value="2"></i><b>(2)</b>
          <span style="color: #008000; font-weight: bold">&quot;ack&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/ack&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;report&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/report&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;start&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/start&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;packages&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/packages&quot;</span>
        },
        <span style="color: #008000; font-weight: bold">&quot;packages&quot;</span>: [ <i class="conum" data-value="3"></i><b>(3)</b>
          {
            <span style="color: #008000; font-weight: bold">&quot;size&quot;</span>: <span style="color: #666666">35768</span>,
            <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
              <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>,
              <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>
            }
          }
        ]
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Note that the parameters are wrapped as a single-element array. This is a workaround for a bug in the current version of RVI, and will likely be removed in subsequent releases.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Every <code>/sota/notify</code> message will include a list of fully qualified names of the sender&#8217;s available services.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This is the real content of the notification: the names, versions, and sizes of the packages to be updated.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the client is ready to receive the package (for example, when the user accepts the update), it sends a message to the RVI node&#8217;s <code>genivi.org/backend/sota/start</code> service.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">2677667615071</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/start&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;timeout&quot;</span>: <span style="color: #666666">1445520390</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;packages&quot;</span>: [ <i class="conum" data-value="1"></i><b>(1)</b>
          {
            <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>,
            <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>
          }
        ],
        <span style="color: #008000; font-weight: bold">&quot;services&quot;</span>: { <i class="conum" data-value="2"></i><b>(2)</b>
          <span style="color: #008000; font-weight: bold">&quot;start&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/start&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;chunk&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/chunk&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;abort&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/abort&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;finish&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/finish&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;getpackages&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/vin/VINOOLAM0FAU2DEEP/sota/getpackages&quot;</span>
        },
        <span style="color: #008000; font-weight: bold">&quot;vin&quot;</span>: <span style="color: #BA2121">&quot;VINOOLAM0FAU2DEEP&quot;</span>
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A list of the packages the client is ready to accept. This needs to be a subset of the packages that the client has been notified about.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is an important requirement to remember: Every time a client sends a <code>/sota/start</code> message, it has to include the fully qualified names of all of its services, except for notify. (Notify isn&#8217;t required because <code>start</code> is a response to <code>notify</code>, so the RVI node must already know about it.)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, the RVI node sends a message to the client&#8217;s <code>/sota/start</code> service for each package the client has accepted, giving an SHA1 checksum and the number of chunks that will be sent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">1</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;/sota/start&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;chunkscount&quot;</span>: <span style="color: #666666">1</span>, <i class="conum" data-value="1"></i><b>(1)</b>
        <span style="color: #008000; font-weight: bold">&quot;checksum&quot;</span>: <span style="color: #BA2121">&quot;e6db09bd2c84db66534107da4ef00e6addccba8e&quot;</span>, <i class="conum" data-value="2"></i><b>(2)</b>
        <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
          <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The package file will be sent in 64kb chunks; this tells the client how many chunks there are in total.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The SHA1 checksum of the final, reassembled file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In response, the client must send an ack message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">2677989151999</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/ack&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;timeout&quot;</span>: <span style="color: #666666">1445520390</span>, <i class="conum" data-value="1"></i><b>(1)</b>
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
          <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>
        },
        <span style="color: #008000; font-weight: bold">&quot;chunks&quot;</span>: [], <i class="conum" data-value="2"></i><b>(2)</b>
        <span style="color: #008000; font-weight: bold">&quot;vin&quot;</span>: <span style="color: #BA2121">&quot;VINOOLAM0FAU2DEEP&quot;</span>
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The timeout is given as a Unix epoch time.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is an array with the list of all the chunks the client already has.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the server receives the ack, it will start sending chunks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">1</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;/sota/chunk&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;index&quot;</span>: <span style="color: #666666">1</span>,
        <span style="color: #008000; font-weight: bold">&quot;bytes&quot;</span>: <span style="color: #BA2121">&quot;7avu2wMAA&lt;rest of base64 encoded data chunk omitted&gt;AAAKWVo=&quot;</span>,
        <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
          <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client sends back an ack each time it receives a chunk; the format is the same as above. Once the server has received an ack for every chunk, it will send a finish message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">1</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;/sota/finish&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
          <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="3-package-installation-and-report">3. Package installation and report</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the client has received all the chunks, it needs to reassemble them into the binary file, and install the package using the system&#8217;s software loading manager. Once it gets the results of the install, it sends a report message back to the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span>{
  <span style="color: #008000; font-weight: bold">&quot;jsonrpc&quot;</span>: <span style="color: #BA2121">&quot;2.0&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;id&quot;</span>: <span style="color: #666666">2680479224662</span>,
  <span style="color: #008000; font-weight: bold">&quot;method&quot;</span>: <span style="color: #BA2121">&quot;message&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;params&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;service_name&quot;</span>: <span style="color: #BA2121">&quot;genivi.org/backend/sota/report&quot;</span>,
    <span style="color: #008000; font-weight: bold">&quot;timeout&quot;</span>: <span style="color: #666666">1445520392</span>,
    <span style="color: #008000; font-weight: bold">&quot;parameters&quot;</span>: [
      {
        <span style="color: #008000; font-weight: bold">&quot;package&quot;</span>: {
          <span style="color: #008000; font-weight: bold">&quot;name&quot;</span>: <span style="color: #BA2121">&quot;ghc&quot;</span>,
          <span style="color: #008000; font-weight: bold">&quot;version&quot;</span>: <span style="color: #BA2121">&quot;7.6.2&quot;</span>
        },
        <span style="color: #008000; font-weight: bold">&quot;status&quot;</span>: <span style="color: #008000; font-weight: bold">true</span>, <i class="conum" data-value="1"></i><b>(1)</b>
        <span style="color: #008000; font-weight: bold">&quot;description&quot;</span>: <span style="color: #BA2121">&quot;Successfully installed package&quot;</span>, <i class="conum" data-value="2"></i><b>(2)</b>
        <span style="color: #008000; font-weight: bold">&quot;vin&quot;</span>: <span style="color: #BA2121">&quot;VINOOLAM0FAU2DEEP&quot;</span>
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A boolean. True for success, false for anything else.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A descriptive status message. Most probably, it&#8217;s easiest to pass the software loading manager&#8217;s status message on directly.</td>
</tr>
</table>
</div>
</div>
</div>

            </div>
        </div>
        <footer class="text-spacing-lg">
    <div class="bright clearfix container-fluid">
        <span class="copyright-links text-spacing-md">
        Doc site built with <a class="menu-link" href="https://asciidoctor.org/">Asciidoctor</a> and <a class="menu-link" href="https://jekyllrb.com/">Jekyll</a>
        </span>
       
        <a class="to-top-small-logo-container" href="#header-navbar">
            <span class="small-logo"></span>
            <span id="to-top"></span>
        </a>
    </div>
</footer>

        
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69301419-1', 'auto');
  ga('send', 'pageview');
</script>

        

        <script src="/rvi_sota_server/js/main.js"></script>
    </body>
</html>
