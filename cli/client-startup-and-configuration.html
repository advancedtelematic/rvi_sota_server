<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>GENIVI SOTA Project : Client Startup and Configuration</title>
        <meta name="description" content="Software Updates Over the Air">

        <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/favicon/manifest.json">
        <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg">
        <link rel="shortcut icon" href="/favicon/favicon.ico">
        <meta name="msapplication-config" content="/favicon/browserconfig.xml">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css"> 
        <link rel="stylesheet" href="/rvi_sota_server/css/main.css">
        <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>
    </head>
    <body>
        
      <nav class="top-bar navbar navbar-default navbar-fixed-top text-spacing-md" id="header-navbar">
        <div class="top-bar container-fluid header-wrapper">
          <div class="top-bar navbar-header">
            <button class="navbar-toggle collapsed menu-selector-btn header-collapse-trigger" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-expanded="false" aria-controls="navbar-menu">
              <span class="sr-only">toggle</span>
              <span class="icon-bar top-bar"></span>
              <span class="icon-bar middle-bar"></span>
              <span class="icon-bar bottom-bar"></span>
            </button>
            <a class="top-bar navbar-brand" href="/rvi_sota_server/index.html"><img class="top-bar unfolded-header" src="/rvi_sota_server/images/icon-logo.png" alt="rvi_sota_server"></a>

          </div>
          <ul class="top-bar nav navbar-nav navbar-right visible-md visible-lg visible-sm">
            <li class="top-bar visible-sm visible-md visible-lg">
              <a class="top-bar ats-garage-btn" href="https://advancedtelematic.com/" target="_blank">Developed by ATS
              </a>
            </li>
          </ul>
          <div class="top-bar navbar-collapse collapse header-collapse-nav" id="navbar-menu">
            <div class="top-bar container center-nav-container">
              <div class="btn-container visible-xs">
                <a class="ico-arrow-top-right btn-small text-center uppercase" href="https://app.atsgarage.com/login" target="_blank">Start Now</a>
              </div>
              <div class="btn-container visible-xs">
                <a class="inverted btn-small text-center uppercase" href="https://app.atsgarage.com/login" target="_blank">Login</a>
              </div>
              <ul class="top-bar nav nav-list navbar-nav">
	            
	                <li class="top-bar "><a href="https://github.com/genivi/rvi_sota_server">Server src (stable)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/advancedtelematic/rvi_sota_server">Server src (dev)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/genivi/rvi_sota_client">Client src (stable)</a></li>
	            
	                <li class="top-bar "><a href="https://github.com/advancedtelematic/rvi_sota_client">Client src (dev)</a></li>
	            
	                <li class="top-bar docs"><a href="http://advancedtelematic.github.io/rvi_sota_server/">Docs</a></li>
	            

                <li class="visible-xs second-menu separator"></li>
                <li class="second-menu visible-xs clearfix">
                  <ul class="column">
                    <li><a href="http://atsgarage.com/en/privacy-policy.html" target="_blank">Privacy Policy</a></li>
                    <li><a href="http://atsgarage.com/en/terms-conditions.html" target="_blank">Terms of Use</a></li>
                    <li><a href="http://atsgarage.com/en/imprint.html" target="_blank">Imprint</a></li>
                  </ul>
                  <ul class="column">
                    <li><a href="https://github.com/advancedtelematic" target="_blank">Github</a></li>
                    <li><a href="https://twitter.com/ats_news" target="_blank">Twitter</a></li>
                  </ul>
                </li>
                <li class="second-menu small-logo visible-xs">
                  <img src="http://advancedtelematic.com/images/ats_small_logo_white.svg" alt="ATS Advanced Telematic Systems">
                </li>
              </ul>
            </div>
          </div>
        </div>
      </nav>
    

        <div id="main-body">
            <button id="toggle-navigation" class="collapsed">Categories</button>
            <div id="navigation" class="collapsed">
                <ul class="nav nav-tabs nav-justified" data-tabs="tabs">
    
    
    
    
    <li  class="active" ><a data-toggle="tab" href="#genivi">GENIVI SOTA</a></li>
    
</ul>

<div class="tab-content">

    
    
    
    

    <div id="genivi" class="tab-pane fade in  active ">

        <ul class="nav nav-list">
        
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Getting Started</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/deployment-with-dockercompose.html">Deploying with docker-compose</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/building-installing.html">Building & Deploying from Source</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/doc/admin-gui-user-guide.html">Admin GUI Guide</a></li>
                    
                
            
                
            
                
            
                
            
        
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Developers</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/contributing.html">Contributing</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/api.html">API</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/application-configuration-options.html">Application configuration options</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/architecture.html">SOTA Architecture</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/scala-style-guide.html">Scala Style Guide</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/messaging-in-rvisotaserver.html">Messaging in rvi_sota_server</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/dev/database-style-guide.html">Database Style Guide</a></li>
                    
                
            
                
            
                
            
        
            
                
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Client Documentation</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/introduction.html">Introduction</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/building-the-sota-client.html">Building the SOTA Client</a></li>
                    
                            
                        <li><a class="nav-link  active " href="/rvi_sota_server/cli/client-startup-and-configuration.html">Client Startup and Configuration</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-commands-and-events-reference.html">Client commands and events API reference</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-implementation.html">RVI Client Implementation Reference</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/cli/client-implementation-example-session.html">RVI Client Implementation Example Session</a></li>
                    
                
            
                
            
        
            
                
            
                
            
                
            
                
                    
                    
                            
                                <li class="nav-header nav-section-title">Reference</li>
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/dependencies.html">Dependencies</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/requirements.html">Requirements</a></li>
                    
                            
                        <li><a class="nav-link " href="/rvi_sota_server/ref/use-cases.html">Use Cases</a></li>
                    
                
            
        
        </ul>

    </div>
    
</div>


            </div>

            <div id="content">
                <div class="page-header">
    <h2>Client Startup and Configuration
        
    </h2>
</div>

<div class="sect1">
<h2 id="starting-the-sota-client">Starting the SOTA client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In general, the SOTA client should be run at startup, as a service. For example, if you&#8217;re using systemd you would want a service file like this:</p>
</div>
<div class="listingblock">
<div class="title">Example: systemd service file</div>
<div class="content">
<pre>[Unit]
Description=SOTA Client
Wants=network-online.target
After=network.target network-online.target
Requires=network-online.target

[Service]
RestartSec=5
Restart=on-failure
Environment="RUST_LOG=info"
DefaultTimeoutStopSec=5
ExecStart=/usr/bin/sota_client --config /etc/sota.toml

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="paragraph">
<p>Systemd is not a requirement, of course; you can use whatever startup system you like, or just run directly from the command line to test.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sota-client-config-file-guide">SOTA Client config file guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The config file for the SOTA client is in TOML format, and can be invoked at startup with <code>sota_client  --config /path/to/config_file.toml</code>. Example config files for use with <a href="https://github.com/genivi/rvi_sota_client/raw/master/tests/genivi.sota.toml">RVI</a> or <a href="https://github.com/genivi/rvi_sota_client/raw/master/tests/sota.toml">HTTP</a> transport are available in the <a href="https://github.com/genivi/rvi_sota_client/">rvi_sota_client</a> repo. If you&#8217;re using a commercial service like <a href="https://app.atsgarage.com">ATS Garage</a>, you&#8217;ve already been provided with a config file; you can use that as a basis for any changes you need to make.</p>
</div>
<div class="sect2">
<h3 id="auth">[auth]</h3>
<div class="paragraph">
<p>This section is required for connection to a SOTA server that implements authentication. It needs to be the first section of the config file. If you are not using authentication, or if you are using RVI transport for authentication, you should <strong>delete</strong> this section entirely.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[auth]
server = "https://auth-plus.gw.prod01.advancedtelematic.com" <i class="conum" data-value="1"></i><b>(1)</b>
client_id = "bf66425f-d4d6-422b-b510-7c7f178af9fe" <i class="conum" data-value="2"></i><b>(2)</b>
client_secret = "hr8nEWzQc9" <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The URL of the auth server. Example given is from <a href="https://app.atsgarage.com">ATS Garage</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A unique client ID and secret for this device.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="core">[core]</h3>
<div class="paragraph">
<p>This section contains configuration for communicating with the Core server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[core]
server = "https://sota-core.gw.prod01.advancedtelematic.com" <i class="conum" data-value="1"></i><b>(1)</b>
polling = true <i class="conum" data-value="2"></i><b>(2)</b>
polling_sec = 10 <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The URL of the Core server. Example given is from <a href="https://app.atsgarage.com">ATS Garage</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Boolean indicating whether the Core server should be polled for new updates. You should turn this off if you are using RVI, or if there is an external component on your device using the <a href="../cli/client-commands-and-events-reference.html#commands">GetUpdateRequests command</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the polling frequency in seconds. This will have no effect if polling is off.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="device">[device]</h3>
<div class="paragraph">
<p>This section contains device-specific configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[device]
uuid = "123e4567-e89b-12d3-a456-426655440000" <i class="conum" data-value="1"></i><b>(1)</b>
system_info = "system_info.sh" <i class="conum" data-value="2"></i><b>(2)</b>
packages_dir = "/tmp/" <i class="conum" data-value="3"></i><b>(3)</b>
package_manager = "off" <i class="conum" data-value="4"></i><b>(4)</b>
auto_download = true <i class="conum" data-value="5"></i><b>(5)</b>
certificates_path = "/tmp/sota_certificates" <i class="conum" data-value="6"></i><b>(6)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The UUID of the device. This is usually assigned by the Core server on device creation. With <a href="https://app.atsgarage.com">ATS Garage</a>, this will be provided in the config file available for download.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The script to use to gather system information. By default, this uses <a href="https://github.com/genivi/rvi_sota_client/blob/master/run/system_info.sh">system_info.sh</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The location SOTA Client should use for temporary package storage until they are processed by the software loading manager.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The software loading manager backend to use. Possible values are <code>deb</code>, <code>rpm</code>, and <code>off</code>. If an external software loading manager is in use, this should be set to <code>off</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Boolean indicating whether the client should automatically start downloading new packages. If this is set to false then an external mechanism will need to trigger the start of the download instead.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The certificate authorities SOTA Client trusts. Defaults are taken from Mozilla Servo.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="gateway">[gateway]</h3>
<div class="paragraph">
<p>The SOTA Client communicates with the device&#8217;s software loading manager (or other interested parties) through various gateways. For more details on how this works, please see the <a href="../cli/client-commands-and-events-reference.html">Client commands and events API reference</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[gateway]
console = false <i class="conum" data-value="1"></i><b>(1)</b>
dbus = false <i class="conum" data-value="2"></i><b>(2)</b>
http = false <i class="conum" data-value="3"></i><b>(3)</b>
rvi = false <i class="conum" data-value="4"></i><b>(4)</b>
socket = false <i class="conum" data-value="5"></i><b>(5)</b>
websocket = true <i class="conum" data-value="6"></i><b>(6)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Start a basic REPL that can send any command to the client. This gateway is used for testing only.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Send a message to D-Bus on available updates, and listen for replies to trigger a download or forward an installation report.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Start a basic HTTP server that will accept new commands and reply with the final event. This gateway is primarily used for testing.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Start an RVI HTTP server that can receive packages from an RVI Erlang client.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Listen on a socket for incoming commands, and broadcast all download events.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Broadcast events to each connected websocket client.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="network">[network]</h3>
<div class="paragraph">
<p>This section contains network configuration information. Some values may be ignored if the corresponding communication methods aren&#8217;t enabled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[network]
http_server = "127.0.0.1:8888" <i class="conum" data-value="1"></i><b>(1)</b>
socket_commands_path = "/tmp/sota-commands.socket" <i class="conum" data-value="2"></i><b>(2)</b>
socket_events_path = "/tmp/sota-events.socket" <i class="conum" data-value="3"></i><b>(3)</b>
websocket_server = "127.0.0.1:9081" <i class="conum" data-value="4"></i><b>(4)</b>
rvi_edge_server = "127.0.0.1:9080" <i class="conum" data-value="5"></i><b>(5)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The host and port the client should listen on for receiving commands (if the http gateway is enabled).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The name of the unix domain socket to be used for receiving commands (if the socket gateway is enabled).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the unix domain socket to be used for listening to <code>DownloadComplete</code> and <code>DownloadFailed</code> events broadcast by client (if the socket gateway is enabled).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The host and port to listen for new websocket clients (if the websocket gateway is enabled).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The host and port the client should listen for RVI messages on (if the rvi gateway is enabled).</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="optional-gateway-rvi">Optional gateway: [rvi]</h4>
<div class="paragraph">
<p>Remote Vehicle Interaction (RVI) is an open source infrastructure developed by GENIVI and Jaguar Land Rover to power the next generation of connected vehicle services. This section contains values for configuration of RVI nodes. Note that having this section defined does not imply that RVI will be used; if the RVI gateway is turned off in the <code>[gateway]</code> section, this is ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[rvi]
client = "http://127.0.0.1:8901"
storage_dir = "/var/sota"
timeout = 20</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optional-gateway-dbus">Optional gateway: [dbus]</h4>
<div class="paragraph">
<p>This section contains values for dbus configuration, using the GENIVI software loading manager&#8217;s names as the default. Note that having this section defined does not imply that dbus will be used; if the dbus gateway is turned off in the <code>[gateway]</code> section, this is ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[dbus]
name = "org.genivi.SotaClient"
path = "/org/genivi/SotaClient"
interface = "org.genivi.SotaClient"
software_manager = "org.genivi.SoftwareLoadingManager"
software_manager_path = "/org/genivi/SoftwareLoadingManager"
timeout = 60</pre>
</div>
</div>
</div>
</div>
</div>
</div>

            </div>
        </div>
        <footer class="text-spacing-lg">
    <div class="bright clearfix container-fluid">
        <span class="copyright-links text-spacing-md">
        Doc site built with <a class="menu-link" href="https://asciidoctor.org/">Asciidoctor</a> and <a class="menu-link" href="https://jekyllrb.com/">Jekyll</a>
        </span>
       
        <a class="to-top-small-logo-container" href="#header-navbar">
            <span class="small-logo"></span>
            <span id="to-top"></span>
        </a>
    </div>
</footer>

        
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69301419-1', 'auto');
  ga('send', 'pageview');
</script>

        

        <script src="/rvi_sota_server/js/main.js"></script>
    </body>
</html>
